{"_path":"/blog/2024/apple_health_parser","_dir":"2024","_draft":false,"_partial":false,"_locale":"","title":"Apple Health Parser","description":"Publishing a Python package to extract, process, and analyse Apple HealthKit data","date":"2024-07-02","readtime":"11","tags":{"language":["python"],"field":["open source","data science","data visualisation"],"type":["package","tool"]},"repo":"https://github.com/alxdrcirilo/apple-health-parser","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"üì¶ "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"PyPI"}]},{"type":"text","value":": "},{"type":"element","tag":"a","props":{"href":"https://pypi.org/project/apple-health-parser","rel":["nofollow"]},"children":[{"type":"text","value":"https://pypi.org/project/apple-health-parser/"}]},{"type":"text","value":" "},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"\nüìù "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Documentation"}]},{"type":"text","value":": "},{"type":"element","tag":"a","props":{"href":"https://alxdrcirilo.dev/apple-health-parser","rel":["nofollow"]},"children":[{"type":"text","value":"https://alxdrcirilo.dev/apple-health-parser"}]}]},{"type":"element","tag":"h2","props":{"id":"preface"},"children":[{"type":"text","value":"Preface"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I've been a happy owner of an Apple Watch for about 4 years now. I must say that I was apprehensive about acquiring one at first, but I've quickly grown to love it. I initially bought one shortly after the COVID-19 pandemic started with the intent of motivating myself to remain active. Little did I know how useful and practical it would be to own one in everyday life, in my experience. Beyond the usual health tracking features associated with smartwatches, some of the use cases of the Apple Watch that I often make use of extend to setting reminders on the fly, recording workouts, checking the weather with one quick glance, and controlling my smart home devices directy from my wrist."}]},{"type":"element","tag":"h3","props":{"id":"sneak-peek"},"children":[{"type":"text","value":"Sneak peek"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here are some of the plots that "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":" can generate:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"header","src":"/images/2024/5.apple_health_parser/apple_health_parser.png"},"children":[]}]},{"type":"element","tag":"p","props":{"className":["figure-caption"]},"children":[{"type":"text","value":"Some plots generated with "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"motivation"},"children":[{"type":"text","value":"Motivation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You may ask:"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"\"But, why would you build a Python package when you can already visualise most metrics straight from your iPhone?\""}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Well, I'm a big data science nerd ü§ì I love finding new ways to visualise data. Every collection of (semi-)structured data has a story, and the fun part of data visualisation is finding a way to tell that story in a clear but memorable way."}]},{"type":"element","tag":"h2","props":{"id":"building-the-apple-health-parser"},"children":[{"type":"text","value":"Building the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]}]},{"type":"element","tag":"h3","props":{"id":"purpose"},"children":[{"type":"text","value":"Purpose"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In a nutshell, "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":" aims to be able to perform:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Extraction and processing of health records from "},{"type":"element","tag":"a","props":{"href":"https://developer.apple.com/documentation/healthkit","rel":["nofollow"]},"children":[{"type":"text","value":"Apple HealthKit"}]},{"type":"text","value":" data"},{"type":"element","tag":"sup","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#user-content-fn-1","ariaDescribedBy":["footnote-label"],"dataFootnoteRef":"","id":"user-content-fnref-1"},"children":[{"type":"text","value":"1"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Parsing and validation of health records"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Plotting (optionally interactive) health records"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Exporting plots and tables from the parsed health records in CSV"},{"type":"element","tag":"sup","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#user-content-fn-2","ariaDescribedBy":["footnote-label"],"dataFootnoteRef":"","id":"user-content-fnref-2"},"children":[{"type":"text","value":"2"}]}]},{"type":"text","value":" format"}]}]},{"type":"element","tag":"h3","props":{"id":"implementation"},"children":[{"type":"text","value":"Implementation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"At the moment of writing of this blog post, the latest version is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"apple-health-parser==0.5.0"}]},{"type":"text","value":". The design choices I will discuss herein reflect versions "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<=0.5.0"}]},{"type":"text","value":", with no guarantee that they will remain in effect in future versions of the package."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are four main classes (only two are directly used by users - marked by "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"*"}]},{"type":"text","value":") in "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":":"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Loader"}]},{"type":"text","value":" (in "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/blob/main/apple_health_parser/utils/loader.py","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"loader.py"}]}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Parser"}]},{"type":"text","value":"* (in "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/blob/main/apple_health_parser/utils/parser.py","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"parser.py"}]}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Preprocessor"}]},{"type":"text","value":" (in "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/blob/main/apple_health_parser/utils/preprocessor.py","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"preprocessor.py"}]}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Plot"}]},{"type":"text","value":"* (in "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/blob/main/apple_health_parser/plot/plots.py","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"plots.py"}]}]},{"type":"text","value":")"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In addition to these main classes, a project-wide logger is defined in "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/blob/main/apple_health_parser/utils/logging.py","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"logging.py"}]}]},{"type":"text","value":"."}]},{"type":"element","tag":"h4","props":{"id":"loader"},"children":[{"type":"text","value":"Loader"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Loader"}]},{"type":"text","value":" class encapsulates all the logic needed to extract the XML data from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"export.zip"}]},{"type":"text","value":" generated by the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Health"}]},{"type":"text","value":" app on the iPhone."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additionally, it also gets the records (i.e. health metrics) and logs some metadata (e.g. export date, birthday, etc.). All four methods in this class are actually static methods (i.e. they are decorated with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@staticmethod"}]},{"type":"text","value":"). Although the functions could indeed have been defined in the global scope (i.e. without being defined within a class), I preferred having them within the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Loader"}]},{"type":"text","value":" class in order to logically group them under a single namespace. These methods are essentially utility functions that don't share state but are related (i.e. they are used in loading the data). In my opinion, this keeps the code more cohesive and it also avoid polluting the global scope."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As a small example, here's the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"read_xml"}]},{"type":"text","value":" method of the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Loader"}]},{"type":"text","value":" class:"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus","code":"@staticmethod\ndef read_xml(xml_file: Path) -> list[ET.Element]:\n    \"\"\"\n    Read an XML file and return the root element.\n\n    Args:\n        xml_file (Path): Path to the XML file\n\n    Returns:\n        list[ET.Element]: List of records (ET.Element)\n    \"\"\"\n    logger.info(f\"Processing {xml_file}...\")\n    with open(xml_file, \"r\") as file:\n        root = ET.parse(file).getroot()\n        Loader._log_metadata(root)\n        return root.findall(\"Record\")\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"@"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"staticmethod\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" read_xml"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"xml_file"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":": Path) -> list[ET.Element]:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Read an XML file and return the root element.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Args:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        xml_file (Path): Path to the XML file\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Returns:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        list[ET.Element]: List of records (ET.Element)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    logger.info("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Processing "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"xml_file"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"...\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"    with"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" open"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"(xml_file, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"r\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":") "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"as"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" file:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        root = ET.parse(file).getroot()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        Loader._log_metadata(root)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" root.findall("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Record\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":")\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This method is responsible for reading an XML file and returning a list of records as "},{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.Element","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ET.Element"}]}]},{"type":"text","value":" objects. The method takes a single argument "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"xml_file"}]},{"type":"text","value":", which is the path to the Apple Health XML file (i.e. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"export.xml"}]},{"type":"text","value":"). The method begins by logging a message indicating the file being processed. It then opens the file (in read-mode - "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"\"r\""}]},{"type":"text","value":") and reads its contents. It then gets the root element of the XML tree, logs some metadata by calling the private method "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_log_metadata"}]},{"type":"text","value":" (i.e. locale, export data, and user metadata), and lastly, it returns a list of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ET.Element"}]},{"type":"text","value":" objects representing the records (i.e. elements with a tag name \"Record\") in the XML file."}]},{"type":"element","tag":"h4","props":{"id":"parser"},"children":[{"type":"text","value":"Parser"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Parser"}]},{"type":"text","value":" class is the bread and butter of the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":" package. It is designed to parse the Apple Health export XML file. It inherits from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Loader"}]},{"type":"text","value":" class, meaning that the end-user will never have to directly interact with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Loader"}]},{"type":"text","value":" class as the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Parser"}]},{"type":"text","value":" class will already internally call the appropriate methods to extract the records from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"export.zip"}]},{"type":"text","value":" file."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are a couple of important methods defined in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Parser"}]},{"type":"text","value":", the most relevant one being the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"get_flag_records"}]},{"type":"text","value":" method. In essence, this function requires a flag or list of flags - health metric(s) (e.g. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HKQuantityTypeIdentifierHeartRate"}]},{"type":"text","value":" represents heart rate records; "},{"type":"element","tag":"a","props":{"href":"https://alxdrcirilo.dev/apple-health-parser/usage/flags","rel":["nofollow"]},"children":[{"type":"text","value":"table of supported flags"}]},{"type":"text","value":"), and it will return a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" object (or dictionary with keys as flags and values as "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" objects). Furthermore, the function is decorated with a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@timeit"}]},{"type":"text","value":" decorator that will just print the execution time of the function to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stdout"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus","code":"@timeit\ndef get_flag_records(\n    self, flag: str | list[str]\n) -> ParsedData | dict[str, ParsedData]:\n    \"\"\"\n    Get parsed data based on the given flag.\n\n    Args:\n        flag (str | list[str]): Flag to parse the records (e.g., `\"HKQuantityTypeIdentifierHeartRate\"`)\n\n    Returns:\n        ParsedData | dict[str, ParsedData]: Parsed data based on the flag(s)\n    \"\"\"\n\n    def _get_parsed_data(flag: str) -> ParsedData:\n        sources = self.get_sources(flag=flag)\n        models = self._build_models(flag=flag)\n        dates = self._get_dates(models=models)\n        records = pd.DataFrame([model.model_dump() for model in models])\n        return ParsedData(flag=flag, sources=sources, dates=dates, records=records)\n\n    if isinstance(flag, str):\n        return _get_parsed_data(flag=flag)\n\n    elif isinstance(flag, list):\n        return {f: _get_parsed_data(flag=f) for f in flag}\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"@timeit\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" get_flag_records"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"    self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" | list["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":") -> ParsedData | dict["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", ParsedData]:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Get parsed data based on the given flag.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Args:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        flag (str | list[str]): Flag to parse the records (e.g., `\"HKQuantityTypeIdentifierHeartRate\"`)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Returns:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        ParsedData | dict[str, ParsedData]: Parsed data based on the flag(s)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" _get_parsed_data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":") -> ParsedData:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        sources = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":".get_sources("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=flag)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        models = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"._build_models("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=flag)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        dates = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"._get_dates("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"models"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=models)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        records = pd.DataFrame([model.model_dump() "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" model "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" models])\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" ParsedData("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=flag, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"sources"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=sources, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"dates"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=dates, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"records"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=records)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"    if"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" isinstance"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"(flag, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" _get_parsed_data("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=flag)\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"    elif"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" isinstance"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"(flag, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"list"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" {f: _get_parsed_data("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=f) "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"for"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" f "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"in"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" flag}\n"}]}]}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"\"What is the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" object?\""}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" object is a dataclass in Python designed to store parsed data from the Apple Health export file. It contains four fields: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"flag"}]},{"type":"text","value":" (e.g. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"\"HKQuantityTypeIdentifierHeartRate\""}]},{"type":"text","value":"), "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sources"}]},{"type":"text","value":" (e.g. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"\"Alexandre's Apple Watch\""}]},{"type":"text","value":"), "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"dates"}]},{"type":"text","value":" (set of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"datetime.date"}]},{"type":"text","value":"), and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"records"}]},{"type":"text","value":" (pandas DataFrame containing the actual records of the parsed data)."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus","code":"@dataclass\nclass ParsedData:\n    \"\"\"\n    Dataclass to store parsed data from the Apple Health export file.\n    \"\"\"\n\n    flag: str\n    sources: list[str]\n    dates: set[date]\n    records: pd.DataFrame\n\n    def __str__(self) -> str:\n        \"\"\"\n        String representation of the ParsedData class.\n        Includes the flag, sources, dates, and number of records.\n\n        Returns:\n            str: String representation of the ParsedData class\n        \"\"\"\n\n        description = [\n            f\"{'Flag:':<12}{self.flag}\",\n            f\"{'Sources:':<12}{len(self.sources)} sources\",\n            f\"{'Dates:':<12}{len(self.dates)} dates\",\n            f\"{'Records:':<12}{len(self.records)} records\",\n        ]\n\n        max_len = len(max(description, key=len))\n        description = [f\"{'ParsedData':=^{max_len}}\"] + description\n\n        return \"\\n\".join(description)\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"@dataclass\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":" ParsedData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    Dataclass to store parsed data from the Apple Health export file.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"    \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    flag: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    sources: list["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    dates: set[date]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    records: pd.DataFrame\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" __str__"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        String representation of the ParsedData class.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        Includes the flag, sources, dates, and number of records.\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        Returns:\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"            str: String representation of the ParsedData class\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"        \"\"\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":20},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":21},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        description = [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":22},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"            f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"'Flag:'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":":<12}{self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":".flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":23},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"            f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"'Sources:'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":":<12}{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":".sources)"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" sources\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":24},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"            f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"'Dates:'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":":<12}{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":".dates)"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" dates\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":25},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"            f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"'Records:'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":":<12}{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":".records)"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" records\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":26},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":27},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":28},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        max_len = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"max"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"(description, "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"))\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":29},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        description = ["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"f"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"'ParsedData'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":":=^{"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"max_len"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"}}"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"] + description\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":30},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":31},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" \""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D7BA7D"},"children":[{"type":"text","value":"\\n"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":".join(description)\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It also includes a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"__str__"}]},{"type":"text","value":" method to provide a string representation of the instance, detailing the flag, number of sources, dates, and records in a human-readable format."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"üí° "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Tip"}]},{"type":"text","value":": Using "},{"type":"element","tag":"a","props":{"href":"https://peps.python.org/pep-0498","rel":["nofollow"]},"children":[{"type":"text","value":"f-string"}]},{"type":"text","value":" formatting (also called "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"literal string interpolation"}]},{"type":"text","value":"), we can pretty print our string! Here's a very useful "},{"type":"element","tag":"a","props":{"href":"https://fstring.help/cheat","rel":["nofollow"]},"children":[{"type":"text","value":"cheatsheet"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When you print a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" object, you will see something similar to the following in your terminal:"}]},{"type":"element","tag":"pre","props":{"className":"language-shell shiki shiki-themes dark-plus","code":"> print(parsed_data)\n=====================ParsedData=====================\nFlag:       HKQuantityTypeIdentifierRestingHeartRate\nSources:    3 sources\nDates:      144 dates\nRecords:    145 records\n","language":"shell","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"> print("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"parsed_data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"=====================ParsedData=====================\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"Flag:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"       HKQuantityTypeIdentifierRestingHeartRate\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"Sources:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8"},"children":[{"type":"text","value":"    3"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" sources\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"Dates:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8"},"children":[{"type":"text","value":"      144"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" dates\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"Records:"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#B5CEA8"},"children":[{"type":"text","value":"    145"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":" records\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Coming back to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"get_flag_records"}]},{"type":"text","value":" method, now that we now what "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" represents, we see that it actually just performs a series of tasks by calling the appropriate methods to generate "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ParsedData"}]},{"type":"text","value":" object(s)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"One line is particularly important:"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus","code":"models = self._build_models(flag=flag)\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"models = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"._build_models("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"flag"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=flag)\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This is essentially the data validation step. Under the hood, this private method is responsible for building "},{"type":"element","tag":"a","props":{"href":"https://docs.pydantic.dev","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Pydantic"}]}]},{"type":"text","value":" models, which leads us to the next subsection."}]},{"type":"element","tag":"h5","props":{"id":"data-validation-using-pydantic-models"},"children":[{"type":"text","value":"Data validation using Pydantic models"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"An Apple Health record (in this case, heart rate record) looks something like this:"}]},{"type":"element","tag":"pre","props":{"className":"language-xml shiki shiki-themes dark-plus","code":"<Record type=\"HKQuantityTypeIdentifierHeartRate\" sourceName=\"Alexandre‚Äôs Apple Watch\" sourceVersion=\"10.2\" device=\"..., name:Apple Watch, manufacturer:Apple Inc., model:Watch, hardware:Watch6,7, software:10.2&gt;\" unit=\"count/min\" creationDate=\"2024-01-01 01:01:42 +0200\" startDate=\"2024-01-01 01:01:36 +0200\" endDate=\"2024-01-01 01:01:36 +0200\" value=\"74\">\n    <MetadataEntry key=\"HKMetadataKeyHeartRateMotionContext\" value=\"0\"/>\n</Record>\n","language":"xml","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#808080"},"children":[{"type":"text","value":"<"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"Record"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" type"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"HKQuantityTypeIdentifierHeartRate\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" sourceName"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Alexandre‚Äôs Apple Watch\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" sourceVersion"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"10.2\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" device"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"..., name:Apple Watch, manufacturer:Apple Inc., model:Watch, hardware:Watch6,7, software:10.2"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"&gt;"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" unit"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"count/min\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" creationDate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"2024-01-01 01:01:42 +0200\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" startDate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"2024-01-01 01:01:36 +0200\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" endDate"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"2024-01-01 01:01:36 +0200\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" value"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"74\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#808080"},"children":[{"type":"text","value":">\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#808080"},"children":[{"type":"text","value":"    <"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"MetadataEntry"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" key"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"HKMetadataKeyHeartRateMotionContext\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":" value"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"0\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#808080"},"children":[{"type":"text","value":"/>\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#808080"},"children":[{"type":"text","value":"</"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"Record"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#808080"},"children":[{"type":"text","value":">\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":", models are defined in "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/blob/main/apple_health_parser/models/records.py","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"records.py"}]}]},{"type":"text","value":" and used to validate data from the records like the one shown above."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As an example, let's take a look at the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HeartRateData"}]},{"type":"text","value":" model which is derived from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HealthData"}]},{"type":"text","value":" model."}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus","code":"class MotionContext(StrEnum):\n    UNSET = \"0\"\n    SEDENTARY = \"1\"\n    ACTIVE = \"2\"\n\n\nclass HeartRateData(HealthData):\n    device: str = Field(title=\"Device\", description=\"Device used for measurement\")\n    motion_context: str = Field(\n        alias=\"motionContext\",\n        title=\"Motion Context\",\n        description=\"Context of motion (e.g. sedentary, active, unset)\",\n        examples=[\"Unset\", \"Sedentary\", \"Active\"],\n    )\n\n    @field_validator(\"motion_context\", mode=\"before\")\n    @classmethod\n    def check_motion_context(cls, v: str) -> str:\n        return MotionContext(v).name.lower().capitalize()\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":" MotionContext"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"StrEnum"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    UNSET = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"0\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    SEDENTARY = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"1\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    ACTIVE = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"2\"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":" HeartRateData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"HealthData"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    device: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" = Field("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"title"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Device\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"description"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Device used for measurement\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    motion_context: "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" = Field(\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"        alias"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"motionContext\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":11},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"        title"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Motion Context\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":12},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"        description"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Context of motion (e.g. sedentary, active, unset)\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":",\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":13},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"        examples"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"=["}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Unset\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Sedentary\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"Active\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"],\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":14},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    )\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":15},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":16},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"    @field_validator"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"motion_context\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"mode"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#CE9178"},"children":[{"type":"text","value":"\"before\""}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":17},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"    @"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"classmethod\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":18},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" check_motion_context"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"cls"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"v"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":": "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":") -> "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":"str"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":19},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"        return"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" MotionContext(v).name.lower().capitalize()\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HeartRateData"}]},{"type":"text","value":" model defines all the fields defined in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"HealthData"}]},{"type":"text","value":" model and extends it by adding two additional fields: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"device"}]},{"type":"text","value":", and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"motion_context"}]},{"type":"text","value":". The former is self-explanatory, whilst the latter defines the type of motion context associated with the heart rate record - i.e. \"unknown\", \"sedentary\", or \"active\". To represent the motion context, we use a "},{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/enum.html#enum.StrEnum","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"StrEnum"}]}]},{"type":"text","value":". Notice that there is a method "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"check_motion_context"}]},{"type":"text","value":" decorated with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@field_validator"}]},{"type":"text","value":". The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"mode=\"before\""}]},{"type":"text","value":" argument specifies that this validation should be performed before the field is set. This method is responsible for setting the appropriate motion context into a human-readable format (e.g. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"\"Active\""}]},{"type":"text","value":") in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"motion_context"}]},{"type":"text","value":" field."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Using Pydantic models ensures that the records parsed from the XML file are correctly structured and valid according to the defined models. This adds a layer of robustness and maintainability to the data parsing logic. This way, if something with the data is unexpected or missing, we can catch it early at the source."}]},{"type":"element","tag":"h4","props":{"id":"plot"},"children":[{"type":"text","value":"Plot"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Plot"}]},{"type":"text","value":" class plays a central role in the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":" package. But before we can actually plot anything, we need the data to be preprocessed. For this, I picked "},{"type":"element","tag":"a","props":{"href":"https://pandas.pydata.org/","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pandas"}]}]},{"type":"text","value":", a widely adopted data analysis library that integrates very well with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"plotly"}]},{"type":"text","value":". The data preprocessing naturally comes after data validation using "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pydantic"}]},{"type":"text","value":", i.e. after the models have been built and validated. Most data will be similar, with some variations for special cases (e.g. heart rate data has "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"motion context"}]},{"type":"text","value":" metadata, sleep data has "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sleep phases"}]},{"type":"text","value":" metadata, etc.). Same goes for plotting, with most plots being similar in the way they are generated with slight variations (e.g. x-axis column name of the pandas DataFrame, title, legend, etc.). And this leads to a really cool concept in programming: "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"interfaces"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h5","props":{"id":"interfaces"},"children":[{"type":"text","value":"Interfaces"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In simple terms, an "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"interface"}]},{"type":"text","value":" defines a set of abstract methods that a class must implement. This ensures that any class that implements the interface will have a certain set of functionalities. It gives us the ability to define how a class should look without specifying the details of the implementation. Furthermore, it can also help us avoid unnecessary code duplication, promoting the use of "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"polymorphism"}]},{"type":"text","value":" - classes can be treated through the same interface despite having different internal implementations. If you think of it at a high level, an interface is like a blueprint that you can reuse all over your codebase."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are multiple ways to define an interface in Python, but for this project I decided to make use of "},{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/abc.html","rel":["nofollow"]},"children":[{"type":"text","value":"Abstract Base Classes"}]},{"type":"text","value":", also called "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"ABCs"}]},{"type":"text","value":"."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"üîç "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Note"}]},{"type":"text","value":": In Python, abstract methods are defined by decorating a method with "},{"type":"element","tag":"a","props":{"href":"https://docs.python.org/3/library/abc.html#abc.abstractmethod","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@abstractmethod"}]}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":", the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Plot"}]},{"type":"text","value":" class inherits from "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PlotInterface"}]},{"type":"text","value":". Here's part of what this interface looks like:"}]},{"type":"element","tag":"pre","props":{"className":"language-python shiki shiki-themes dark-plus","code":"from abc import ABC, abstractmethod\n\nclass PlotInterface(ABC):\n    @abstractmethod\n    def _get_figure(self, data):\n        # Implement case-specific method to get figure\n    \n    def plot(self):\n        figure = self._get_figure()\n        # Do something with figure\n","language":"python","meta":"","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"from"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" abc "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#C586C0"},"children":[{"type":"text","value":"import"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":" ABC, abstractmethod\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"emptyLinePlaceholder":true},"children":[{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"class"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#4EC9B0"},"children":[{"type":"text","value":" PlotInterface"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"(ABC):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":"    @abstractmethod\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" _get_figure"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955"},"children":[{"type":"text","value":"        # Implement case-specific method to get figure\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":7},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"    \n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":8},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"    def"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#DCDCAA"},"children":[{"type":"text","value":" plot"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#9CDCFE"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"):\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":9},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"        figure = "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#569CD6"},"children":[{"type":"text","value":"self"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D4D4D4"},"children":[{"type":"text","value":"._get_figure()\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":10},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A9955"},"children":[{"type":"text","value":"        # Do something with figure\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We use the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@abstractmethod"}]},{"type":"text","value":" decorator to make the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_get_figure"}]},{"type":"text","value":" method abstract, i.e. any subclass of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PlotInterface"}]},{"type":"text","value":" needs to implement "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_get_figure"}]},{"type":"text","value":". You'll notice that there is also another method in this example - the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"plot"}]},{"type":"text","value":" method. This is a regular (or "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"concrete"}]},{"type":"text","value":") method - a method that provides a concrete implementation. This method is designed to call the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_get_figure"}]},{"type":"text","value":" method to obtain a figure and them perform a set of operations that are ubiquitous to any possible subclass of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PlotInterface"}]},{"type":"text","value":", i.e. showing and saving the plot. This way, we do not need to implement it in subclasses of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PlotInterface"}]},{"type":"text","value":". On the other hand, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"_get_figure"}]},{"type":"text","value":" is case-specific, e.g. heatmaps have different requirements than standard plots (e.g. scatter plots) in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"plotly"}]},{"type":"text","value":" library."}]},{"type":"element","tag":"h3","props":{"id":"cicd"},"children":[{"type":"text","value":"CI/CD"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This project was the first time I went the extra mile to set up proper CI/CD"},{"type":"element","tag":"sup","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#user-content-fn-3","ariaDescribedBy":["footnote-label"],"dataFootnoteRef":"","id":"user-content-fnref-3"},"children":[{"type":"text","value":"3"}]}]},{"type":"text","value":". CI/CD done right can have a tremendous impact on a project, including: faster release cycles (thanks to automated testing, formatting, and linting) and bug detection, increased reliability (less human error), and immediate feedback, among others."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This project is hosted on GitHub and makes use of GitHub Actions - a CI/CD platform to automate build, test, and deployment pipelines defined in so-called "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"workflows"}]},{"type":"text","value":". For the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Apple Health Parser"}]},{"type":"text","value":" package, I've defined "},{"type":"element","tag":"a","props":{"href":"https://github.com/alxdrcirilo/apple-health-parser/tree/main/.github/workflows","rel":["nofollow"]},"children":[{"type":"text","value":"four workflows"}]},{"type":"text","value":":"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Commit lint and semantic versioning (using "},{"type":"element","tag":"a","props":{"href":"https://github.com/wagoid/commitlint-github-action","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"commitlint"}]}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"https://github.com/python-semantic-release/python-semantic-release","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"python-semantic-release"}]}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Unit test coverage (using "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pytest"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pytest-cov"}]},{"type":"text","value":", with the coverage report uploaded to "},{"type":"element","tag":"a","props":{"href":"https://coveralls.io/github/alxdrcirilo/apple-health-parser?branch=main","rel":["nofollow"]},"children":[{"type":"text","value":"Coveralls"}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Deploy documentation to GitHub Pages (using "},{"type":"element","tag":"a","props":{"href":"https://www.mkdocs.org/","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"mkdocs"}]}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Publish to "},{"type":"element","tag":"a","props":{"href":"https://pypi.org","rel":["nofollow"]},"children":[{"type":"text","value":"PyPI"}]},{"type":"text","value":" (using "},{"type":"element","tag":"a","props":{"href":"https://github.com/JRubics/poetry-publish","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"poetry-publish"}]}]},{"type":"text","value":")"}]}]},{"type":"element","tag":"h2","props":{"id":"outro"},"children":[{"type":"text","value":"Outro"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you're interested in reading more about interfaces, and abstract base classes in particular, I highly recommend the following reads:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://stackoverflow.com/a/53213772","rel":["nofollow"]},"children":[{"type":"text","value":"\"Is it a good practice to put common methods to an abstract class in Python?\""}]},{"type":"text","value":" - Stack Overflow"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://realpython.com/python-interface","rel":["nofollow"]},"children":[{"type":"text","value":"Implementing an Interface in Python"}]},{"type":"text","value":" - RealPython"}]}]},{"type":"element","tag":"section","props":{"className":["footnotes"],"dataFootnotes":""},"children":[{"type":"element","tag":"h2","props":{"className":["sr-only"],"id":"footnote-label"},"children":[{"type":"text","value":"Footnotes"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{"id":"user-content-fn-1"},"children":[{"type":"text","value":"From the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"export.zip"}]},{"type":"text","value":" file you can generate from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Health"}]},{"type":"text","value":" app on your iPhone "},{"type":"element","tag":"a","props":{"href":"#user-content-fnref-1","ariaLabel":"Back to reference 1","className":["data-footnote-backref"],"dataFootnoteBackref":""},"children":[{"type":"text","value":"‚Ü©"}]}]},{"type":"element","tag":"li","props":{"id":"user-content-fn-2"},"children":[{"type":"text","value":"Comma-separated values "},{"type":"element","tag":"a","props":{"href":"#user-content-fnref-2","ariaLabel":"Back to reference 2","className":["data-footnote-backref"],"dataFootnoteBackref":""},"children":[{"type":"text","value":"‚Ü©"}]}]},{"type":"element","tag":"li","props":{"id":"user-content-fn-3"},"children":[{"type":"text","value":"Continuous Integration/Continuous Deployment "},{"type":"element","tag":"a","props":{"href":"#user-content-fnref-3","ariaLabel":"Back to reference 3","className":["data-footnote-backref"],"dataFootnoteBackref":""},"children":[{"type":"text","value":"‚Ü©"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"Table of Contents","searchDepth":3,"depth":5,"links":[{"id":"preface","depth":2,"text":"Preface","children":[{"id":"sneak-peek","depth":3,"text":"Sneak peek"},{"id":"motivation","depth":3,"text":"Motivation"}]},{"id":"building-the-apple-health-parser","depth":2,"text":"Building the Apple Health Parser","children":[{"id":"purpose","depth":3,"text":"Purpose"},{"id":"implementation","depth":3,"text":"Implementation","children":[{"id":"loader","depth":4,"text":"Loader"},{"id":"parser","depth":4,"text":"Parser","children":[{"id":"data-validation-using-pydantic-models","depth":5,"text":"Data validation using Pydantic models"}]},{"id":"plot","depth":4,"text":"Plot","children":[{"id":"interfaces","depth":5,"text":"Interfaces"}]}]},{"id":"cicd","depth":3,"text":"CI/CD"}]},{"id":"outro","depth":2,"text":"Outro"},{"id":"footnote-label","depth":2,"text":"Footnotes"}]}},"_type":"markdown","_id":"content:blog:2024:5.apple_health_parser.md","_source":"content","_file":"blog/2024/5.apple_health_parser.md","_stem":"blog/2024/5.apple_health_parser","_extension":"md"}